close all
clear all
%% Database

epsilon = 0.01;
 outline = [1.10000000000000,1;25.1875000000000,1;25.1875000000000,25.9375000000000;1.10000000000000,25.9375000000000];
%  outline = [-5.50000000000000,2.50000000000000;-1.50000000000000,2.50000000000000;-1.50000000000000,7.50000000000000;-0.500000000000000,7.50000000000000;-0.500000000000000,2.50000000000000;13.5000000000000,2.50000000000000;13.5000000000000,5.50000000000000;3.50000000000000,5.50000000000000;0.500000000000000,5.50000000000000;0.500000000000000,6.50000000000000;3.50000000000000,6.50000000000000;4.50000000000000,6.50000000000000;5.50000000000000,6.50000000000000;7.50000000000000,6.50000000000000;7.50000000000000,7.50000000000000;5.50000000000000,7.50000000000000;5.50000000000000,10.5000000000000;7.50000000000000,10.5000000000000;7.50000000000000,11.5000000000000;5.50000000000000,11.5000000000000;4.50000000000000,11.5000000000000;2.50000000000000,11.5000000000000;2.50000000000000,8.50000000000000;2,8.50000000000000;2,11.5000000000000;-5.50000000000000,11.5000000000000];
%  outline = [0.500000000000000,0.500000000000000;7.50000000000000,0.500000000000000;7.50000000000000,8.50000000000000;11.5000000000000,8.50000000000000;11.5000000000000,4.50000000000000;8.50000000000000,4.50000000000000;8.50000000000000,0.500000000000000;18.5000000000000,0.500000000000000;18.5000000000000,4.50000000000000;12.5000000000000,4.50000000000000;12.5000000000000,8.50000000000000;16.5000000000000,8.50000000000000;16.5000000000000,6.50000000000000;16.5000000000000,6.50000000000000;18.5000000000000,6.50000000000000;18.5000000000000,14.5000000000000;16.5000000000000,14.5000000000000;16.5000000000000,9.50000000000000;12.5000000000000,9.50000000000000;12.5000000000000,13.5000000000000;15.5000000000000,13.5000000000000;15.5000000000000,14.5000000000000;11.5000000000000,14.5000000000000;11.5000000000000,9.50000000000000;7.50000000000000,9.50000000000000;7.50000000000000,14.5000000000000;0.500000000000000,14.5000000000000];
%  outline = [0.500000000000000,3.50000000000000;8.50000000000000,3.50000000000000;8.50000000000000,0.500000000000000;9.50000000000000,0.500000000000000;9.50000000000000,3.50000000000000;15.5000000000000,3.50000000000000;15.5000000000000,0.500000000000000;16.5000000000000,0.500000000000000;16.5000000000000,3.50000000000000;22.5000000000000,3.50000000000000;22.5000000000000,0.500000000000000;23.5000000000000,0.500000000000000;23.5000000000000,3.50000000000000;26.5000000000000,3.50000000000000;26.5000000000000,12.5000000000000;22.5000000000000,12.5000000000000;22.5000000000000,4.50000000000000;19.5000000000000,4.50000000000000;19.5000000000000,10.5000000000000;15.5000000000000,10.5000000000000;15.5000000000000,4.50000000000000;12.5000000000000,4.50000000000000;12.5000000000000,8.50000000000000;8.50000000000000,8.50000000000000;8.50000000000000,4.50000000000000;5.50000000000000,4.50000000000000;5.50000000000000,7.50000000000000;2.50000000000000,7.50000000000000;2.50000000000000,4.50000000000000;0.500000000000000,4.50000000000000];
% outline = [0.500000000000000,0.500000000000000;11.5000000000000,0.500000000000000;11.5000000000000,7.50000000000000;10.5000000000000,7.50000000000000;10.5000000000000,8.50000000000000;12.5000000000000,8.50000000000000;12.5000000000000,0.500000000000000;50.5000000000000,0.500000000000000;50.5000000000000,30.5000000000000;0.500000000000000,30.5000000000000;0.500000000000000,22.5000000000000;0.500000000000000,21.5000000000000;0.500000000000000,12.5000000000000;8.50000000000000,12.5000000000000;8.50000000000000,11.5000000000000;0.500000000000000,11.5000000000000;0.500000000000000,8.50000000000000;8.50000000000000,8.50000000000000;8.50000000000000,7.50000000000000;0.500000000000000,7.50000000000000];
% outline = [0.500000000000000,6.50000000000000;7.50000000000000,6.50000000000000;7.50000000000000,2.50000000000000;14.5000000000000,2.50000000000000;14.5000000000000,6.50000000000000;15.5000000000000,6.50000000000000;15.5000000000000,2.50000000000000;17.5000000000000,2.50000000000000;17.5000000000000,6.50000000000000;18.5000000000000,6.50000000000000;18.5000000000000,2.50000000000000;25.5000000000000,2.50000000000000;25.5000000000000,11.5000000000000;18.5000000000000,11.5000000000000;18.5000000000000,7.50000000000000;17.5000000000000,7.50000000000000;17.5000000000000,11.5000000000000;15.5000000000000,11.5000000000000;15.5000000000000,7.50000000000000;14.5000000000000,7.50000000000000;14.5000000000000,11.5000000000000;7.50000000000000,11.5000000000000;7.50000000000000,7.50000000000000;0.500000000000000,7.50000000000000];


Number_of_Obstacles = 80;
% % 
% % Obstacles_List = {[8.20000000000000,7.70000000000000;10.2000000000000,7.70000000000000;10.2000000000000,6.20000000000000;8.20000000000000,6.20000000000000];
% %     [12.3000000000000,7.50000000000000;14.6000000000000,7.50000000000000;14.6000000000000,6.40000000000000;12.3000000000000,6.40000000000000];
% %     [6.40000000000000,12.6000000000000;7.70000000000000,12.6000000000000;7.70000000000000,10.7000000000000;9.70000000000000,10.7000000000000;9.70000000000000,9.20000000000000;6.50000000000000,9.20000000000000];
% %     [13.6000000000000,16.5000000000000;15.2000000000000,15.6000000000000;13.7000000000000,11.7000000000000;11.5000000000000,12.5000000000000];
% %     [16.3000000000000,10.7000000000000;17.6000000000000,10.2000000000000;16.7000000000000,8.80000000000000;15.5000000000000,9.30000000000000];
% %     [17.5000000000000,13.2000000000000;19.2000000000000,12.5000000000000;18.5000000000000,11.200000000000;16.7000000000000,11.7000000000000];
% %     [18.2000000000000,16.5000000000000;20.2000000000000,15.7000000000000;19.3000000000000,13.8000000000000;18.2000000000000,14.3000000000000];
% %     [7.30000000000000,17.4000000000000;8.40000000000000,17.4000000000000;8.40000000000000,14.1000000000000;7.30000000000000,14.1000000000000];
% %     [2.30000000000000,16.4000000000000;5.40000000000000,16.4000000000000;5.40000000000000,15.1000000000000;2.30000000000000,15.1000000000000];
% %     [6.70000000000000,21.5000000000000;7.50000000000000,21.5000000000000;7.50000000000000,19.2000000000000;6.70000000000000,19.2000000000000];
% %     [8.60000000000000,21.2000000000000;11.3000000000000,21.2000000000000;11.3000000000000,19.2000000000000;10.5000000000000,19.2000000000000;10.5000000000000,20.3000000000000;8.60000000000000,20.3000000000000];
% %     [13.2000000000000,21.3000000000000;17.7000000000000,21.3000000000000;17.7000000000000,20.5000000000000;16.5000000000000,20.5000000000000;16.5000000000000,19.3000000000000;15.7000000000000,19.3000000000000;15.7000000000000,20.5000000000000;13.2000000000000,20.5000000000000];
% %     [20.7000000000000,21.7000000000000;22.7000000000000,21.7000000000000;22.7000000000000,18.5000000000000;20.7000000000000,18.5000000000000];
% %     [6.70000000000000,1.20000000000000;6.70000000000000,6.70000000000000;7.70000000000000,6.70000000000000;7.70000000000000,1.20000000000000];
% %     [1.50000000000000,1.50000000000000;1.50000000000000,2.50000000000000;9.50000000000000,2.50000000000000;9.50000000000000,1.50000000000000];
% %     [2.50000000000000,5.50000000000000;2.50000000000000,7.50000000000000;3.50000000000000,7.50000000000000;3.50000000000000,5.50000000000000];
% %     [7.50000000000000,3.50000000000000;7.50000000000000,4.50000000000000;8.50000000000000,4.50000000000000;8.50000000000000,3.50000000000000];
% %     [5.50000000000000,7.50000000000000;5.50000000000000,8.50000000000000;6.50000000000000,8.50000000000000;6.50000000000000,7.50000000000000];
% %     [8.50000000000000,5.50000000000000;8.50000000000000,6.50000000000000;9.40000000000000,6.50000000000000;9.40000000000000,5.50000000000000];
% %     [2.50000000000000,3.50000000000000;2.50000000000000,7.50000000000000;3.50000000000000,7.50000000000000;3.50000000000000,3.50000000000000];
% %     [9.50000000000000,5.50000000000000;9.50000000000000,8.50000000000000;12.5000000000000,8.50000000000000;12.5000000000000,5.50000000000000]};


Obstacles_List = {[8.20000000000000,7.70000000000000;10.2000000000000,7.70000000000000;10.2000000000000,6.20000000000000;8.20000000000000,6.20000000000000];
    [7.30000000000000,17.4000000000000;8.40000000000000,17.4000000000000;8.40000000000000,14.1000000000000;7.30000000000000,14.1000000000000];
    [2.30000000000000,16.4000000000000;5.40000000000000,16.4000000000000;5.40000000000000,15.1000000000000;2.30000000000000,15.1000000000000];
    [6.70000000000000,21.5000000000000;7.50000000000000,21.5000000000000;7.50000000000000,19.2000000000000;6.70000000000000,19.2000000000000];
    [8.60000000000000,21.2000000000000;11.3000000000000,21.2000000000000;11.3000000000000,19.2000000000000;10.5000000000000,19.2000000000000;10.5000000000000,20.3000000000000;8.60000000000000,20.3000000000000];
    [13.2000000000000,21.3000000000000;17.7000000000000,21.3000000000000;17.7000000000000,20.5000000000000;16.5000000000000,20.5000000000000;16.5000000000000,19.3000000000000;15.7000000000000,19.3000000000000;15.7000000000000,20.5000000000000;13.2000000000000,20.5000000000000];
    [20.7000000000000,21.7000000000000;22.7000000000000,21.7000000000000;22.7000000000000,18.5000000000000;20.7000000000000,18.5000000000000];
    [6.70000000000000,1.20000000000000;6.70000000000000,6.70000000000000;7.70000000000000,6.70000000000000;7.70000000000000,1.20000000000000];
    [1.50000000000000,1.50000000000000;1.50000000000000,2.50000000000000;9.50000000000000,2.50000000000000;9.50000000000000,1.50000000000000];
    [2.50000000000000,5.50000000000000;2.50000000000000,7.50000000000000;3.50000000000000,7.50000000000000;3.50000000000000,5.50000000000000];
    [7.50000000000000,3.50000000000000;7.50000000000000,4.50000000000000;8.50000000000000,4.50000000000000;8.50000000000000,3.50000000000000];
    [5.50000000000000,7.50000000000000;5.50000000000000,8.50000000000000;6.50000000000000,8.50000000000000;6.50000000000000,7.50000000000000];
    [8.50000000000000,5.50000000000000;8.50000000000000,6.50000000000000;9.40000000000000,6.50000000000000;9.40000000000000,5.50000000000000];
    [2.50000000000000,3.50000000000000;2.50000000000000,7.50000000000000;3.50000000000000,7.50000000000000;3.50000000000000,3.50000000000000];
    [9.50000000000000,5.50000000000000;9.50000000000000,8.50000000000000;12.5000000000000,8.50000000000000;12.5000000000000,5.50000000000000]};

len = size(Obstacles_List,1);
%% Generate the position of the obstacles
for i = 1:len
    temp = Obstacles_List{i,1};
    j = size(temp,1);
    start_point = temp(1,:);
    for j = 1:size(temp,1)
        temp(j,:) = temp(j,:) - start_point;
    end
    Obstacles_List{i,1} = temp;
end

environment{1,1} = outline;
environment_min_x = min(environment{1}(:,1));
environment_max_x = max(environment{1}(:,1));
environment_min_y = min(environment{1}(:,2));
environment_max_y = max(environment{1}(:,2));

Obstacles_Count = 1; 
for k = 1: Number_of_Obstacles
    x = randi([round(environment_min_x),round(environment_max_x)]);
    y = randi([round(environment_min_x),round(environment_max_x)]);
    Obstacle = Obstacles_List{randi([1,size(Obstacles_List,1)]),1};
    Obstacle(:,1) = Obstacle(:,1) + x;
    Obstacle(:,2) = Obstacle(:,2) + y;
    %check is the points in environment or not
    Pass = 0;
    for n = 1:size(Obstacle,1)
        if in_environment( [Obstacle(n,1) Obstacle(n,2)] , environment , epsilon ) ...
                && in_environment( [Obstacle(n,1)+0.5 Obstacle(n,2)+0.5] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)+0.5 Obstacle(n,2)-0.5] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)-0.5 Obstacle(n,2)+0.5] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)-0.5 Obstacle(n,2)-0.5] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)+1 Obstacle(n,2)] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)+1 Obstacle(n,2)] , environment , epsilon )...
                && in_environment( [Obstacle(n,1) Obstacle(n,2)+1] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)-1 Obstacle(n,2)] , environment , epsilon )...
                && in_environment( [Obstacle(n,1) Obstacle(n,2)-1] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)+1 Obstacle(n,2)+1] , environment , epsilon )...
                && in_environment( [Obstacle(n,1)-1 Obstacle(n,2)-1] , environment , epsilon )
            Pass = Pass + 1;
        else
            break
        end
    end
    
    if Pass == size(Obstacle,1)
       environment{1,Obstacles_Count+1} = Obstacle;
       Obstacles_Count = Obstacles_Count+1;
    end
    
end

%% Generate assets
while 1
    Teammate1 = [randi([round(environment_min_x),round(environment_max_x)]),randi([round(environment_min_x),round(environment_max_x)])];
    if in_environment( Teammate1 , environment , epsilon )
        break;
    end
end

while 1
    Teammate2 = [randi([round(environment_min_x),round(environment_max_x)]),randi([round(environment_min_x),round(environment_max_x)])];
    if in_environment( Teammate2 , environment , epsilon )
        break;
    end
end

%% plot
X_MIN = environment_min_x-0.1*(environment_max_x-environment_min_x);
X_MAX = environment_max_x+0.1*(environment_max_x-environment_min_x);
Y_MIN = environment_min_y-0.1*(environment_max_y-environment_min_y);
Y_MAX = environment_max_y+0.1*(environment_max_y-environment_min_y);



%Clear plot and form window with desired properties
hold on; grid on;
axis equal; axis off; axis([X_MIN X_MAX+4 Y_MIN Y_MAX]);


%Plot Environment
patch( environment{1}(:,1) , environment{1}(:,2) , 0.1*ones(1,length(environment{1}(:,1)) ) , ...
    'w' , 'linewidth' , 1.5 );
for i = 2 : size(environment,2)
    patch( environment{i}(:,1) , environment{i}(:,2) , 0.1*ones(1,length(environment{i}(:,1)) ) , ...
        'k' , 'EdgeColor' , [0 0 0] , 'FaceColor' , [0.8 0.8 0.8] , 'linewidth' , 1.5 );
end





X_MIN = environment_min_x-0.1*(environment_max_x-environment_min_x);
X_MAX = environment_max_x+0.1*(environment_max_x-environment_min_x);
Y_MIN = environment_min_y-0.1*(environment_max_y-environment_min_y);
Y_MAX = environment_max_y+0.1*(environment_max_y-environment_min_y);

axis equal; axis off; axis([X_MIN X_MAX+4 Y_MIN Y_MAX]);


%Plot Environment
patch( environment{1}(:,1) , environment{1}(:,2) , 0.1*ones(1,length(environment{1}(:,1)) ) , ...
    'w' , 'linewidth' , 1.5 );
hold on;
for i = 2 : size(environment,2)
    patch( environment{i}(:,1) , environment{i}(:,2) , 0.1*ones(1,length(environment{i}(:,1)) ) , ...
        'k' , 'EdgeColor' , [0 0 0] , 'FaceColor' , [0.8 0.8 0.8] , 'linewidth' , 1.5 );
end

%Plot assets

plot3(Teammate1(1),Teammate1(2), 0.3 , ...
    'p' , 'Markersize' , 16, 'MarkerFaceColor' , [0.9,0.8,0.7],'MarkerFaceColor','r','MarkerEdgeColor','r' );
plot3(Teammate2(1),Teammate2(2), 0.3 , ...
    'p' , 'Markersize' , 16, 'MarkerFaceColor' , [0.9,0.8,0.7],'MarkerFaceColor','r','MarkerEdgeColor','r' );
hold off

